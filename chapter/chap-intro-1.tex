
\chapter{绪论}
\label{chap:introduction}
\section{研究背景及意义}
中国互联网络信息中心（CNNIC）发布的第~33~次《中国互联网络发展状况统计报告》\cite{cnnic}~显示，截至~2013~年~12~月，我国网民规模达到~6.18~亿，全年新增网民~5358~万人，互联网普及率为~45.8\%~。 在~3G~网络进一步普及，智能手机和无线网络持续发展的背景下，视频、音乐等高流量应用拥有越来越多的用户。截至~2013~年~12~月，我国手机端在线收看或下载视频的用户数为~2.47~亿，与~2012~年底相比增长了~1.12~亿，增长率高达~83.8\%~。图片、音频和视频等多媒体业务的大幅增长对基础设施服务提供商提出了巨大的挑战。由于多媒体业务对~QoS~ 服务质量要求苛刻，譬如严格的带宽需求保障、较小的延时保障和严格的延时抖动限制等。因此，如何提供合适的服务平台来承载媒体业务，如何保障媒体业务的~QoS~服务质量等等都具有很高的研究价值和广阔的市场前景。
\par
随着海量数据需求的日益增加，云计算技术以及海量数据处理技术得到越来越多的关注和重视。云计算\cite{cloud-1,cloud-2}可以算是继个人电脑、互联网后的又一个革命性技术，它彻底改变了我们使用信息技术的方式。时至今日，云计算的影响力已经席卷了~IT~行业的各个角落，云计算相关的产品和服务层出不穷，对人们的生活和工作产生了深远的影响。公认的云计算先驱~Salesforce\cite{salesforce}~通过向企业客户销售基于云的~SaaS~软件及服务产品，CRM\cite{crm}，成长为一家年销售额超过~20~ 亿美元的公司。~Salesforce~第一次将~SaaS~服务大规模地销售给了企业用户，进一步证明了基于云计算的产品和服务不仅仅是大型业务系统的的廉价替代品，它还可以是真正提高企业运营效率、促进业务发展的解决方案，并维持极高标准的可靠性。
\par
在线零售商~Amazon\cite{amazon}~为提高用户体验，在数据中心配置了大量冗余的服务器设备以缓冲圣诞购物季的高峰时段流量。冗余配置使得数据中心在大部分时间只有不到~10\%~的资源利用率，剩下~90\%~ 的资源都是闲置的。因此，~Amazon~于~2006~ 年对外发布了~Amazon EC2\cite{ec2-web}~ 弹性云计算服务，面向公众提供基础架构的云服务，IaaS，将闲置的服务器资源以按需付费的弹性方式开放给公众，以提高资源利用率。~Amazon EC2~是云计算的一个里程碑，它是业界第一个将基础架构大规模开放给公众用户的云计算服务，用户可以在~Amazon EC2~ 平台上搭建并部署从~Linux~到~Windows~ 的任何业务，而且用户可根据业务的实际需求使用云服务资源并支付费用。除了~EC2~ 之外，~Amazon~ 还发布了~S3\cite{s3}、SQS\cite{sqs}~等云计算服务，组成了完整的~AWS~ 产品线，合理利用数据中心的闲置服务器资源，提高资源利用率。
\par
继~Amazon AWS~之后，各大厂商都相继涌进云计算的大潮中，各种各样的云计算产品和服务如雨后春笋般不断涌现。~2009~年，~Google~开始对外提供~Google App Engine\cite{gae-1,gae-2}~服务，通过提供完整的~Web~ 开发环境，用户只需要在浏览器里开发、调试自己的代码，然后部署到~Google~云平台上，就可以直接对外发布并提供服务。~Microsoft~也在云计算的浪潮中发布了自己的云计算产品~Windows Azure\cite{ma}。
\par
云计算意味着用户不再需要购置高昂的设备，也不再需要面临各种部署压力和维护成本。用户可直接选择各种各样的云计算服务，并按业务需求支付费用。云计算将物理设备的购置、维护和部署转嫁给云计算服务提供商，尤其是基础设施云服务提供商。通过云计算服务提供商雄厚的资本实力和专业的维护、部署，提供高效率和高可靠性的云计算服务。在私有云服务中，用户可将已购置的或闲置的物理设备搭建成云计算服务平台，整合内部的各种资源和服务并进行统一管理和分配，以最大化资源的利用率。目前，构建云服务平台的虚拟化管理系统层出不穷，譬如~OpenStack\cite{openstack}、Eucalyptus\cite{eucalyptus-1,eucalyptus-2}、
OpenNebula\cite{opennebula}、CloudStack\cite{cloudstack}~等。这些虚拟化管理系统可以辅助用户高效地搭建云计算服务平台。
\par
目前的虚拟化管理系统大多是面向硬件资源共享的。然而，在实际应用中，常常会用到许多独立的服务，如媒体业务中经常涉及的存储、转码、流化服务。如果将这些独立的服务作为基本服务单元，一方面可以使其更好的为不同系统提供高质量服务，另一方面将硬件资源通过多服务类型虚拟，提高了利用率，降低了部署和运营成本，应用和研究价值均较强。
\par
因此，本文面向媒体业务的虚拟化网络服务设计与开发，以服务虚拟化平台~SuperNova~为依托开展研究和开发工作，研究了面向媒体业务的虚拟化网络服务的关键问题和技术，包括虚拟网络嵌入、资源映射交互技术、业务流量隔离与控制以及服务虚拟化平台~SuperNova~的功能完善等。

\section{研究内容及面临的挑战}
在传统的服务模式下，随着业务的增长和用户的增加，基础设施服务提供商常常通过部署服务器集群、增加服务器设备数量来为用户提供可靠服务。这种传统的服务模式在当今快速发展的互联网络环境下已不再适合。一方面，传统的服务模式给基础设施服务提供商带来了巨大的设备成本和部署压力。另一方面，这些部署的大量设备根本得不到充分利用，造成巨大的资源浪费。虚拟化技术对解决这个问题具有很大的优势，它通过建立统一的资源管控系统，管理所有的设备并进行虚拟化，按需为业务分配资源，显著提高了资源利用率，大大减少了服务器设备成本和部署开销。
\par
\begin{figure}[h]
\includegraphics[width=\textwidth]{supernova-jiagou.eps}
\caption{SuperNova系统架构示意图}
\label{fig:supernova-jiagou1}
\end{figure}
\par
本文以~863~项目“融合网络业务体系的开发”中服务虚拟化平台~SuperNova~为依托开展研究和开发。服务虚拟化平台~SuperNova~的架构示意图如图\ref{fig:supernova-jiagou1}所示。服务虚拟化平台~SuperNova~提供一种基于服务虚拟化、具有云服务特征、开放接口的网络系统及实现方法。通过将分布在不同地理位置的物理服务器设备连接起来，采用虚拟化技术以大粒度服务的形式对外提供资源，实现多种业务共享硬件资源，并满足用户对媒体业务的服务质量要求。服务虚拟化平台~SuperNova~将物理设备层屏蔽起来，根据上层应用的业务需求，以接口的方式为上层提供服务，应用无需了解任何网络细节或者硬件情况，可根据业务需求获得弹性服务。按照功能划分，服务虚拟化平台包括：虚拟连接层、虚拟独立服务单元层、服务协作层、服务控制层和全局认知管理层。
\par
本文在服务虚拟化平台~SuperNova~上开展研究和开发工作，并主要集中在服务控制层和全局认知管理层。本文的研究内容及面临的挑战可归结为以下几个方面：\par
\textbf{1）虚拟网络嵌入}\par
虚拟网络嵌入是网络虚拟化的关键内容，通过在共享的物理网络上实例化虚拟网络请求，有效地将虚拟网络请求拓扑中的虚拟节点和虚拟链接嵌入映射到底层物理网络上，最大化从底层物理网络中获得的收益，获取最佳的动态资源分配，从而为最终用户提供定制的端到端保证的服务。虚拟网络嵌入问题是~NP~难问题，其时间复杂度非常高。因此，现有的研究大多都侧重于设计基于启发式的算法来解决。然而，现有的启发式算法均不适合服务虚拟化平台，它们没有充分利用服务虚拟化平台~SuperNova~的独有特征。因此，在服务虚拟化平台~SuperNova~ 中，设计符合平台特性的虚拟网络嵌入算法是需要考虑的问题。如何对虚拟网络嵌入问题进行建模；如何挖掘服务虚拟化平台~SuperNova~的独有特征；如何减少虚拟网络嵌入的时间复杂度以及如何提高底层物理网络的资源利用率等都是值得研究的问题。
\par
\textbf{2）业务流量隔离与控制}\par
业务流量隔离与控制系统对于提高业务服务的可靠性，防止数据流量串扰，提高业务的服务质量有着非常重要的作用。它通过利用软件或硬件工具，实现对不同业务的网络流量的隔离与控制，消除不同业务以及不同流量之间的干扰。流量隔离与控制最主要的方法是引入~QoS~，通过为不同类型的网络数据包作标记，并决定不同标记的数据包通行的方式以及优先次序。目前，主要的流量控制方式包括流量整形、流量调度、流量监管和丢弃。在服务虚拟化平台~SuperNova~ 中，汇集了众多的服务器资源，并支撑着大量不同的业务。因此，如何设计业务流量隔离与控制系统是很关键的问题。业务流量隔离和控制系统采用什么样的架构；采用什么流量控制工具；如何划分不同的流量以及如何控制流量等都是值得研究的问题。
\par
\textbf{3）服务虚拟化平台功能实现}\par
不管是虚拟网络嵌入还是业务流量隔离与控制系统，其理论研究和工程实现都有着巨大的差距。通常，理论研究更注重准确性和高性能，而工程开发和应用实现更加注重可行性和高效率。因此，如何在服务虚拟化平台~SuperNova~上高效率地实现高性能的虚拟网络嵌入算法是值得研究的问题。具体而言，包括如何对虚拟网络嵌入算法进行简化，怎样进行工程开发和细节简化，以及需要在哪些方面进行折衷等等都是需要仔细推敲和琢磨的。同样，在服务虚拟化平台~SuperNova~ 上如何实现业务流量隔离与控制系统也需要进行相应的折衷考虑和工程开发设计。另外，作为对外开放使用的服务虚拟化平台~SuperNova~，用户体验质量是至关重要的。因此，如何进行呈现设计，开放给用户什么样的~API~ 接口，如何更好地提高用户体验质量都是值得研究和考虑的问题。

\section{本文主要贡献}
本文面向媒体业务的虚拟化网络服务设计与开发的主要贡献可归结为以下几点：\par
\textbf{1、面向媒体业务的虚拟网络嵌入算法~MSO-VNE~}\par
本文结合服务虚拟化平台~SuperNova~的应用场景和平台特性，设计并提出了面向媒体业务的虚拟网络嵌入算法~MSO-VNE~。MSO-VNE~算法根据虚拟网络请求和底层物理网络的地理位置特征，应用节点聚类算法，充分利用了分而治之思想和并发处理思想，显著降低了虚拟网络嵌入处理的时间复杂度。MSO-VNE~算法充分考虑了节点在网络拓扑中的重要性，通过动态服务均衡分析，显著提高了虚拟网络嵌入的性能和底层物理网络的资源利用率，增加了基础设施提供商的长期收益。
\par
\textbf{2、面向媒体业务的资源映射交互框架}\par
本文基于面向媒体业务的虚拟网络嵌入算法~MSO-VNE~，提出了面向媒体业务的资源映射交互框架。资源映射交互框架主要包括用户接口模块、预处理模块、资源映射模块、资源分配模块以及资源监控模块。其中，资源映射模块是核心模块，它通过利用~MSO-VNE~嵌入映射算法进行资源映射匹配计算，以获得更好的~QoS~服务质量。资源映射交互框架可有效地提高用户体验质量。
\par
\textbf{3、业务流量隔离与控制系统}\par
本文基于~Linux~流量控制模块~TC~设计了多层次结构的业务流量隔离与控制系统。通过虚拟局域网~VLAN~实现不可见性隔离，即虚拟局域网中的同一个~VLAN~内的成员可相互通信，而不同~VLAN~之间是相互隔离和不可见的。通过区分数据流量，并规定不同的数据流被发送的方式和顺序实现流量控制和互不影响性隔离。业务流量隔离与控制系统封装了~Linux TC~ 的控制命令，隐藏了实现细节，简化了用户操作，提高了用户体验。另外，通过开放一定的~API~ 控制接口，用户可以根据实际业务的需求对流量控制规则进行自定义重配置。业务流量隔离与控制系统可以有效地隔离不同用户之间的业务流量干扰，也为用户提供了一种区分不同业务、实现较高~QoS~服务质量的工具。
\par
\textbf{4、服务虚拟化平台的工程开发}\par
服务虚拟化平台的工程开发主要包括三个部分：首先是虚拟网络嵌入算法在服务虚拟化平台中的工程实现；其次是业务流量隔离与控制系统在服务虚拟化平台中的工程实现；最后是为提高用户体验质量而附加的部分功能实现，包括实例管理，存储管理，安全组管理等。无论是哪个模块组件，在工程实现时都充分考虑了可实现性和高效率性，以达到较好的用户体验质量。
\section{本文内容安排}
本文共分为六章，对面向媒体业务的虚拟化网络服务进行研究和开发，其中第三、四、五章是本文的核心研究内容。本文各章的内容概述如下：
\par
第一章为“绪论”，介绍了本文的研究背景、研究意义、研究内容及面临的挑战和主要贡献。
\par
第二章为“相关技术背景及技术基础”，介绍了面向媒体业务的虚拟化网络服务相关的技术，包括云计算技术、虚拟化技术以及网络流量控制技术，这些相关技术为本文的研究做了必要的准备和技术支持。
\par
第三章为“面向媒体业务的虚拟网络嵌入研究”。本章通过研究面向媒体业务的虚拟化平台的特性，提出了面向媒体业务的虚拟网络嵌入算法~MSO-VNE~，并通过仿真实验验证了该算法的性能。另外，本章基于~MSO-VNE~算法，设计了面向媒体业务的资源映射交互框架，以简化资源映射交互流程并提高用户体验质量。
\par
第四章为“业务流量隔离与控制”，解决了业务之间的流量干扰问题，实现了业务流量的隔离和控制。本章基于~Linux TC~流量控制模块，设计了业务流量隔离和控制框架，并设计仿真实验验证了其隔离和流量控制性能。
\par
第五章为“~SuperNova~系统工程开发”。本章详细阐述了在服务虚拟化平台~SuperNova~上实现流量控制模块、虚拟网络嵌入模块、云控制器模块的方案设计与编程开发。
\par
第六章为“总结和展望”，总结了本文的研究工作，并指出了面向媒体业务的虚拟化网络服务的进一步研究方向。
